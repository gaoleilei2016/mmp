<style type="text/css">
</style>
<template>
	<div id="ims_order_main">
		<el-menu default-active="1-4-1" id="prescription_menu" class="el-col-4 el-menu-vertical-demo" @open="handleOpen" @close="handleClose" :collapse="isCollapse">

		  <el-menu-item index="1" @click="show_panel('out_order')">
		    <i class="el-icon-goods"></i>
		    <span >发药</span>  
		  </el-menu-item>

		  <el-menu-item index="2" @click="show_panel('return_drug')">
		    <i class="el-icon-sold-out"></i>
		    <span >退药</span>  
		  </el-menu-item>

		  <el-menu-item index="3" @click="show_panel('reports')">
		    <i class="el-icon-document"></i>
		    <span >报表</span>
		  </el-menu-item>

		  <el-menu-item index="4" @click="show_panel('settings')">
		    <i class="el-icon-setting"></i>
		    <span >设置</span>
		  </el-menu-item>
		  
		</el-menu>

		<div class="function_panel out_order">
			<%= render "ims/home/render/out_order"%>
		</div>

		<div class="function_panel return_drug" style="display:none;">
			<%#= render "ims/home/render/return_order"%>
		</div>

		<div class="function_panel reports" style="display:none;">
			<%#= render "ims/home/render/order_reports"%>
		</div>

		<div class="function_panel settings" style="display:none;">
			<%#= render "ims/home/render/settings"%>
		</div>

	</div>
</template>
<script type="text/javascript">
window.current_template_obj = {
	data:function(){
		return {
      isCollapse: true,
      out_order_search:"",
      out_list_panel:"1",
      detail:[{}],
      activeName2:'first',
      pres:[],
		}
	},
	methods:{
    init:function(){},
    handleOpen:function(key, keyPath) {
      console.log(key, keyPath);
    },
    handleClose:function(key, keyPath) {
      console.log(key, keyPath);
    },
    show_panel:function(method){

    },
    out_order_search_fun:function(e){},
    get_out_pres:function(tab,event){
      var _this = this
      var stat = _this.out_list_panel
      // console.log(_this.out_list_panel)
      _this.$http.get('/ims/orders/get_orders?stat='+stat).then(function(response) {
        if(response.data.data&&response.data.data.length>0){
          _this.set_pres(response.data.data)
        }else{
          _this.set_pres([])
        }
      },function(response){
        _this.set_pres()
        _this.$notify({
          title: '提示',
          message: '服务器请求出错了',
          duration: 0
        });
      });
    },
    set_pres:function(data){
      if (data) {
        this._data.pres = data
      }else{
        this._data.pres = []
      }
    },
    out_order:function(id){
    },
    get_pre:function (id,e) {
      var _this = this;
      if(e)$(e.currentTarget).addClass("active").siblings("p").removeClass("active")
      if (!id) {
        id="";
        _this.$notify({
          title: '提示',
          message: '订单信息不全！',
          duration: 0
        });
        return ""
      };
      _this.$http.get('/ims/orders/get_order?id='+id).then(function(response) {
        console.log(response.data.order)
        _this._data.detail = response.data.order
        // setTimeout(function(){  _this._data.detail =  [_this.tab_header_data[0]] },300)
      },function(response){
        _this.$notify({
          title: '提示',
          message: '服务器请求出错了',
          duration: 0
        });
      });
    },
    format_time:function(data){
      var time = new Date(data)
      if (data) {
        return time.toLocaleDateString().replace(/\//g,"-")+" "+time.toTimeString().slice(0,5)
      }else{
        return "未知"
      }
    },
    format_price:function(data){
      if (data) {
        return Number(data)==NaN ? 0.00 : parseFloat(data).toFixed(2)
      }else{
        return ""
      }
    },
	},
	mounted:function(){
		this.$nextTick(function(){
			this.init();
		})	
	}
}
</script>
